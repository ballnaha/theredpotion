{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/theredpotion/apps/customer/theme.ts"],"sourcesContent":["'use client';\r\n\r\nimport { createTheme, ThemeOptions } from '@mui/material/styles';\r\n\r\n// iOS Liquid Glass Color Palette\r\nconst colors = {\r\n  primary: {\r\n    main: 'rgba(0, 122, 255, 0.85)', // iOS Blue with transparency\r\n    light: 'rgba(0, 122, 255, 0.6)',\r\n    dark: 'rgba(0, 122, 255, 1)',\r\n  },\r\n  secondary: {\r\n    main: 'rgba(255, 59, 48, 0.85)', // iOS Red with transparency\r\n    light: 'rgba(255, 59, 48, 0.6)',\r\n    dark: 'rgba(255, 59, 48, 1)',\r\n  },\r\n  background: {\r\n    default: 'rgba(242, 242, 247, 0.9)', // iOS light background with transparency\r\n    paper: 'rgba(255, 255, 255, 0.7)', // Glass effect\r\n    glass: 'rgba(255, 255, 255, 0.25)', // Frosted glass\r\n    glassSecondary: 'rgba(255, 255, 255, 0.15)',\r\n  },\r\n  surface: {\r\n    primary: 'rgba(255, 255, 255, 0.8)',\r\n    secondary: 'rgba(248, 248, 248, 0.9)',\r\n    tertiary: 'rgba(242, 242, 247, 0.8)',\r\n  },\r\n  accent: {\r\n    green: 'rgba(52, 199, 89, 0.85)',\r\n    orange: 'rgba(255, 149, 0, 0.85)',\r\n    purple: 'rgba(175, 82, 222, 0.85)',\r\n    pink: 'rgba(255, 45, 85, 0.85)',\r\n  },\r\n};\r\n\r\n// Glass morphism shadows and blurs\r\nconst glassMorphism = {\r\n  backdrop: 'blur(20px) saturate(180%)',\r\n  backdropSecondary: 'blur(40px) saturate(200%)',\r\n  shadow: {\r\n    glass: '0 8px 32px rgba(31, 38, 135, 0.37)',\r\n    soft: '0 4px 16px rgba(0, 0, 0, 0.1)',\r\n    medium: '0 8px 24px rgba(0, 0, 0, 0.15)',\r\n    strong: '0 12px 40px rgba(0, 0, 0, 0.2)',\r\n  },\r\n  border: 'rgba(255, 255, 255, 0.18)',\r\n};\r\n\r\nconst themeOptions: ThemeOptions = {\r\n  palette: {\r\n    mode: 'light',\r\n    primary: colors.primary,\r\n    secondary: colors.secondary,\r\n    background: colors.background,\r\n    text: {\r\n      primary: 'rgba(0, 0, 0, 0.87)',\r\n      secondary: 'rgba(0, 0, 0, 0.6)',\r\n    },\r\n  },\r\n  typography: {\r\n    fontFamily: [\r\n      '\"Prompt\"',\r\n      '-apple-system',\r\n      'BlinkMacSystemFont',\r\n      '\"SF Pro Display\"',\r\n      '\"SF Pro Text\"',\r\n      '\"Helvetica Neue\"',\r\n      'Arial',\r\n      'sans-serif',\r\n    ].join(','),\r\n    h1: {\r\n      fontSize: '1.75rem',\r\n      fontWeight: 700,\r\n      letterSpacing: '-0.02em',\r\n      '@media (min-width:600px)': {\r\n        fontSize: '2.5rem',\r\n      },\r\n    },\r\n    h2: {\r\n      fontSize: '1.5rem',\r\n      fontWeight: 600,\r\n      letterSpacing: '-0.01em',\r\n      '@media (min-width:600px)': {\r\n        fontSize: '2rem',\r\n      },\r\n    },\r\n    h3: {\r\n      fontSize: '1.375rem',\r\n      fontWeight: 600,\r\n      '@media (min-width:600px)': {\r\n        fontSize: '1.75rem',\r\n      },\r\n    },\r\n    h4: {\r\n      fontSize: '1.25rem',\r\n      fontWeight: 600,\r\n      '@media (min-width:600px)': {\r\n        fontSize: '1.5rem',\r\n      },\r\n    },\r\n    h5: {\r\n      fontSize: '1.125rem',\r\n      fontWeight: 600,\r\n      '@media (min-width:600px)': {\r\n        fontSize: '1.25rem',\r\n      },\r\n    },\r\n    h6: {\r\n      fontSize: '1rem',\r\n      fontWeight: 600,\r\n      '@media (min-width:600px)': {\r\n        fontSize: '1.125rem',\r\n      },\r\n    },\r\n    body1: {\r\n      fontSize: '0.875rem',\r\n      lineHeight: 1.6,\r\n      '@media (min-width:600px)': {\r\n        fontSize: '1rem',\r\n      },\r\n    },\r\n    body2: {\r\n      fontSize: '0.75rem',\r\n      lineHeight: 1.5,\r\n      '@media (min-width:600px)': {\r\n        fontSize: '0.875rem',\r\n      },\r\n    },\r\n  },\r\n  shape: {\r\n    borderRadius: 16, // iOS-style rounded corners\r\n  },\r\n  shadows: [\r\n    'none',\r\n    glassMorphism.shadow.soft,\r\n    glassMorphism.shadow.soft,\r\n    glassMorphism.shadow.medium,\r\n    glassMorphism.shadow.medium,\r\n    glassMorphism.shadow.medium,\r\n    glassMorphism.shadow.strong,\r\n    glassMorphism.shadow.strong,\r\n    glassMorphism.shadow.strong,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n    glassMorphism.shadow.glass,\r\n  ],\r\n  components: {\r\n    MuiCssBaseline: {\r\n      styleOverrides: {\r\n        body: {\r\n          background: `\r\n            linear-gradient(135deg, \r\n              rgba(74, 144, 226, 0.1) 0%, \r\n              rgba(102, 126, 234, 0.1) 100%\r\n            )\r\n          `,\r\n          minHeight: '100vh',\r\n          WebkitBackdropFilter: glassMorphism.backdrop,\r\n          backdropFilter: glassMorphism.backdrop,\r\n        },\r\n      },\r\n    },\r\n    MuiPaper: {\r\n      styleOverrides: {\r\n        root: {\r\n          backgroundColor: colors.background.paper,\r\n          backdropFilter: glassMorphism.backdrop,\r\n          WebkitBackdropFilter: glassMorphism.backdrop,\r\n          border: `1px solid ${glassMorphism.border}`,\r\n          borderRadius: 16,\r\n        },\r\n      },\r\n    },\r\n    MuiCard: {\r\n      styleOverrides: {\r\n        root: {\r\n          backgroundColor: colors.background.glass,\r\n          backdropFilter: glassMorphism.backdropSecondary,\r\n          WebkitBackdropFilter: glassMorphism.backdropSecondary,\r\n          border: `1px solid ${glassMorphism.border}`,\r\n          borderRadius: 20,\r\n          boxShadow: glassMorphism.shadow.glass,\r\n          transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\r\n          '&:hover': {\r\n            transform: 'translateY(-4px)',\r\n            boxShadow: glassMorphism.shadow.strong,\r\n          },\r\n        },\r\n      },\r\n    },\r\n    MuiButton: {\r\n      styleOverrides: {\r\n        root: {\r\n          borderRadius: 12,\r\n          textTransform: 'none',\r\n          fontWeight: 600,\r\n          backdropFilter: glassMorphism.backdrop,\r\n          WebkitBackdropFilter: glassMorphism.backdrop,\r\n          transition: 'all 0.2s cubic-bezier(0.4, 0, 0.2, 1)',\r\n        },\r\n        contained: {\r\n          backgroundColor: colors.primary.main,\r\n          color: 'white',\r\n          border: `1px solid ${glassMorphism.border}`,\r\n          '&:hover': {\r\n            backgroundColor: colors.primary.dark,\r\n            transform: 'translateY(-2px)',\r\n            boxShadow: glassMorphism.shadow.medium,\r\n          },\r\n        },\r\n        outlined: {\r\n          backgroundColor: colors.background.glassSecondary,\r\n          backdropFilter: glassMorphism.backdrop,\r\n          WebkitBackdropFilter: glassMorphism.backdrop,\r\n          border: `1px solid ${glassMorphism.border}`,\r\n          '&:hover': {\r\n            backgroundColor: colors.background.glass,\r\n            transform: 'translateY(-1px)',\r\n          },\r\n        },\r\n      },\r\n    },\r\n    MuiAppBar: {\r\n      styleOverrides: {\r\n        root: {\r\n          backgroundColor: colors.background.glass,\r\n          backdropFilter: glassMorphism.backdrop,\r\n          WebkitBackdropFilter: glassMorphism.backdrop,\r\n          border: 'none',\r\n          borderBottom: `1px solid ${glassMorphism.border}`,\r\n          boxShadow: 'none',\r\n        },\r\n      },\r\n    },\r\n    MuiTextField: {\r\n      styleOverrides: {\r\n        root: {\r\n          '& .MuiOutlinedInput-root': {\r\n            backgroundColor: colors.background.glassSecondary,\r\n            backdropFilter: glassMorphism.backdrop,\r\n            WebkitBackdropFilter: glassMorphism.backdrop,\r\n            borderRadius: { xs: 8, sm: 12 },\r\n            fontSize: { xs: '14px', sm: '16px' },\r\n            minHeight: { xs: '40px', sm: '48px' },\r\n            '& fieldset': {\r\n              border: `1px solid ${glassMorphism.border}`,\r\n            },\r\n            '&:hover fieldset': {\r\n              border: `1px solid ${colors.primary.light}`,\r\n            },\r\n            '&.Mui-focused fieldset': {\r\n              border: `2px solid ${colors.primary.main}`,\r\n            },\r\n            '&.MuiInputBase-sizeSmall': {\r\n              minHeight: { xs: '36px', sm: '40px' },\r\n              fontSize: { xs: '13px', sm: '14px' },\r\n            },\r\n          },\r\n          '& .MuiInputBase-input': {\r\n            padding: { xs: '8px 12px', sm: '12px 16px' },\r\n            fontSize: { xs: '14px', sm: '16px' },\r\n            '&.MuiInputBase-inputSizeSmall': {\r\n              padding: { xs: '6px 10px', sm: '8px 12px' },\r\n              fontSize: { xs: '13px', sm: '14px' },\r\n            },\r\n          },\r\n        },\r\n      },\r\n    },\r\n  },\r\n};\r\n\r\nconst theme = createTheme(themeOptions);\r\n\r\n// Extend theme with custom properties\r\ndeclare module '@mui/material/styles' {\r\n  interface Palette {\r\n    glass: {\r\n      primary: string;\r\n      secondary: string;\r\n      tertiary: string;\r\n    };\r\n    accent: {\r\n      green: string;\r\n      orange: string;\r\n      purple: string;\r\n      pink: string;\r\n    };\r\n  }\r\n\r\n  interface PaletteOptions {\r\n    glass?: {\r\n      primary?: string;\r\n      secondary?: string;\r\n      tertiary?: string;\r\n    };\r\n    accent?: {\r\n      green?: string;\r\n      orange?: string;\r\n      purple?: string;\r\n      pink?: string;\r\n    };\r\n  }\r\n}\r\n\r\n// Add custom properties to theme\r\nexport const liquidGlassTheme = createTheme({\r\n  ...themeOptions,\r\n  palette: {\r\n    ...themeOptions.palette,\r\n    glass: {\r\n      primary: colors.surface.primary,\r\n      secondary: colors.surface.secondary,\r\n      tertiary: colors.surface.tertiary,\r\n    },\r\n    accent: colors.accent,\r\n  },\r\n});\r\n\r\nexport default liquidGlassTheme; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 342, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/theredpotion/apps/customer/src/app/utils/tenant.ts"],"sourcesContent":["// Multi-Tenant Management System\n\nexport interface TenantConfig {\n  id: string;\n  name: string;\n  subdomain: string;\n  domain: string;\n  liffId?: string;\n  theme: {\n    primaryColor: string;\n    logo: string;\n    brandName: string;\n  };\n  settings: {\n    deliveryFee: number;\n    freeDeliveryThreshold: number;\n    serviceFeeRate: number;\n    currency: string;\n  };\n}\n\n// Mock tenant configurations (à¸ˆà¸£à¸´à¸‡à¹† à¸ˆà¸°à¸”à¸¶à¸‡à¸ˆà¸²à¸ database)\nconst TENANT_CONFIGS: { [key: string]: TenantConfig } = {\n  'restaurant1': {\n    id: 'restaurant1',\n    name: 'Green Garden Organic',\n    subdomain: 'restaurant1',\n    domain: 'theredpotion.treetelu.com',\n    liffId: '2007609360-3Z0L8Ekg', // ðŸ”¥ LIFF ID for development\n    theme: {\n      primaryColor: '#10b981',\n      logo: '/images/restaurant1-logo.png',\n      brandName: 'Green Garden'\n    },\n    settings: {\n      deliveryFee: 39,\n      freeDeliveryThreshold: 200,\n      serviceFeeRate: 0.02,\n      currency: 'THB'\n    }\n  },\n  'restaurant2': {\n    id: 'restaurant2',\n    name: 'Zen Healthy Treats',\n    subdomain: 'restaurant2',\n    domain: 'theredpotion.treetelu.com',\n    liffId: '2007609360-3Z0L8Ekg', // ðŸ”¥ Same LIFF ID for all restaurants\n    theme: {\n      primaryColor: '#7c3aed',\n      logo: '/images/restaurant2-logo.png',\n      brandName: 'Zen Treats'\n    },\n    settings: {\n      deliveryFee: 49,\n      freeDeliveryThreshold: 250,\n      serviceFeeRate: 0.025,\n      currency: 'THB'\n    }\n  },\n  'restaurant3': {\n    id: 'restaurant3',\n    name: 'Fresh Bowl Co.',\n    subdomain: 'restaurant3',\n    domain: 'theredpotion.treetelu.com',\n    liffId: '2007609360-3Z0L8Ekg', // ðŸ”¥ Same LIFF ID for all restaurants\n    theme: {\n      primaryColor: '#f59e0b',\n      logo: '/images/restaurant3-logo.png',\n      brandName: 'Fresh Bowl'\n    },\n    settings: {\n      deliveryFee: 35,\n      freeDeliveryThreshold: 180,\n      serviceFeeRate: 0.015,\n      currency: 'THB'\n    }\n  }\n};\n\n// Detect tenant from current URL\nexport const detectTenant = (): string | null => {\n  if (typeof window === 'undefined') return null;\n  \n  const hostname = window.location.hostname;\n  const pathname = window.location.pathname;\n  \n  // Method 1: Domain detection for theredpotion.treetelu.com\n  if (hostname === 'theredpotion.treetelu.com') {\n    console.log('Tenant detected from domain: restaurant1 (default)');\n    return 'restaurant1';\n  }\n  \n  // Method 1b: Subdomain detection (fallback)\n  if (hostname !== 'localhost' && hostname !== '127.0.0.1') {\n    const subdomain = hostname.split('.')[0];\n    if (TENANT_CONFIGS[subdomain]) {\n      console.log('Tenant detected from subdomain:', subdomain);\n      return subdomain;\n    }\n  }\n  \n  // Method 2: Path-based detection\n  const pathSegments = pathname.split('/').filter(Boolean);\n  if (pathSegments.length > 0) {\n    const potentialTenant = pathSegments[0];\n    if (TENANT_CONFIGS[potentialTenant]) {\n      console.log('Tenant detected from path:', potentialTenant);\n      return potentialTenant;\n    }\n  }\n  \n  // Method 3: URL parameter (for development/testing)\n  const urlParams = new URLSearchParams(window.location.search);\n  const tenantParam = urlParams.get('tenant');\n  if (tenantParam && TENANT_CONFIGS[tenantParam]) {\n    console.log('Tenant detected from parameter:', tenantParam);\n    return tenantParam;\n  }\n  \n  // Default tenant for development\n  if (hostname === 'localhost' || hostname === '127.0.0.1') {\n    console.log('Development mode, using default tenant');\n    return 'restaurant1';\n  }\n  \n  return null;\n};\n\n// Get tenant configuration\nexport const getTenantConfig = (tenantId?: string): TenantConfig | null => {\n  const tenant = tenantId || detectTenant();\n  if (!tenant) return null;\n  \n  return TENANT_CONFIGS[tenant] || null;\n};\n\n// Get current tenant configuration\nexport const getCurrentTenant = (): TenantConfig | null => {\n  return getTenantConfig();\n};\n\n// Check if current request is for a specific tenant\nexport const isTenantRequest = (): boolean => {\n  return detectTenant() !== null;\n};\n\n// Get tenant-specific API base URL\nexport const getTenantApiUrl = (tenantId?: string): string => {\n  const tenant = tenantId || detectTenant();\n  if (!tenant) return '/api';\n  \n  return `/api/tenant/${tenant}`;\n};\n\n// Get tenant-specific storage key\nexport const getTenantStorageKey = (key: string, tenantId?: string): string => {\n  const tenant = tenantId || detectTenant();\n  if (!tenant) return key;\n  \n  return `${tenant}_${key}`;\n};\n\n// Tenant-aware localStorage\nexport const getTenantLSItem = (key: string): string | null => {\n  try {\n    if (typeof window === 'undefined') return null;\n    const tenantKey = getTenantStorageKey(key);\n    return localStorage.getItem(tenantKey);\n  } catch (error) {\n    console.warn('getTenantLSItem failed:', error);\n    return null;\n  }\n};\n\nexport const setTenantLSItem = (key: string, value: string): boolean => {\n  try {\n    if (typeof window === 'undefined') return false;\n    const tenantKey = getTenantStorageKey(key);\n    localStorage.setItem(tenantKey, value);\n    return true;\n  } catch (error) {\n    console.warn('setTenantLSItem failed:', error);\n    return false;\n  }\n};\n\nexport const removeTenantLSItem = (key: string): boolean => {\n  try {\n    if (typeof window === 'undefined') return false;\n    const tenantKey = getTenantStorageKey(key);\n    localStorage.removeItem(tenantKey);\n    return true;\n  } catch (error) {\n    console.warn('removeTenantLSItem failed:', error);\n    return false;\n  }\n};\n\n// Get all available tenants (for admin)\nexport const getAllTenants = (): TenantConfig[] => {\n  return Object.values(TENANT_CONFIGS);\n};\n\n// Validate tenant exists\nexport const validateTenant = (tenantId: string): boolean => {\n  return tenantId in TENANT_CONFIGS;\n};\n\n// Generate tenant URL\nexport const generateTenantUrl = (tenantId: string, path: string = ''): string => {\n  const config = TENANT_CONFIGS[tenantId];\n  if (!config) return '';\n  \n  const protocol = typeof window !== 'undefined' ? window.location.protocol : 'https:';\n  return `${protocol}//${config.domain}${path}`;\n};\n\n// LINE LIFF integration\nexport const getTenantLiffId = (tenantId?: string): string | null => {\n  const tenant = tenantId || detectTenant();\n  if (!tenant) return null;\n  \n  const config = TENANT_CONFIGS[tenant];\n  return config?.liffId || null;\n};\n\n// Check if current LIFF matches tenant\nexport const validateTenantLiff = (): boolean => {\n  const currentTenant = detectTenant();\n  if (!currentTenant) return true; // Allow if no tenant detected\n  \n  const expectedLiffId = getTenantLiffId(currentTenant);\n  if (!expectedLiffId) return true; // Allow if no LIFF configured\n  \n  // In real implementation, you would check against actual LIFF context\n  // For now, just return true\n  return true;\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 553, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/theredpotion/apps/customer/src/app/components/TenantDetector.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState, ReactNode } from 'react';\r\nimport { useSearchParams, usePathname } from 'next/navigation';\r\n\r\ninterface TenantDetectorProps {\r\n  children: ReactNode;\r\n  onTenantDetected?: (tenantId: string | null) => void;\r\n}\r\n\r\n// Client-side only tenant detection\r\nconst detectTenantFromUrl = (): string | null => {\r\n  if (typeof window === 'undefined') return null;\r\n  \r\n  const hostname = window.location.hostname;\r\n  const pathname = window.location.pathname;\r\n  const urlParams = new URLSearchParams(window.location.search);\r\n  \r\n  const TENANT_CONFIGS = ['restaurant1', 'restaurant2', 'restaurant3'];\r\n  \r\n  // Method 1: Subdomain detection\r\n  if (hostname !== 'localhost' && hostname !== '127.0.0.1' && hostname !== 'theredpotion.com') {\r\n    const subdomain = hostname.split('.')[0];\r\n    if (TENANT_CONFIGS.includes(subdomain)) {\r\n      return subdomain;\r\n    }\r\n  }\r\n  \r\n  // Method 2: Path-based detection\r\n  const pathSegments = pathname.split('/').filter(Boolean);\r\n  if (pathSegments.length > 0) {\r\n    const potentialTenant = pathSegments[0];\r\n    if (TENANT_CONFIGS.includes(potentialTenant)) {\r\n      return potentialTenant;\r\n    }\r\n  }\r\n  \r\n  // Method 3: URL parameter\r\n  const tenantParam = urlParams.get('tenant');\r\n  if (tenantParam && TENANT_CONFIGS.includes(tenantParam)) {\r\n    return tenantParam;\r\n  }\r\n  \r\n  // Default for development\r\n  if (hostname === 'localhost' || hostname === '127.0.0.1' || hostname === 'theredpotion.com') {\r\n    return 'restaurant1';\r\n  }\r\n  \r\n  return null;\r\n};\r\n\r\nexport default function TenantDetector({ children, onTenantDetected }: TenantDetectorProps) {\r\n  const [detectedTenant, setDetectedTenant] = useState<string | null>(null);\r\n  const [isClient, setIsClient] = useState(false);\r\n  const searchParams = useSearchParams();\r\n  const pathname = usePathname();\r\n\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isClient) {\r\n      const tenant = detectTenantFromUrl();\r\n      setDetectedTenant(tenant);\r\n      onTenantDetected?.(tenant);\r\n    }\r\n  }, [isClient, searchParams, pathname, onTenantDetected]);\r\n\r\n  // Don't render children until client-side\r\n  if (!isClient) {\r\n    return null;\r\n  }\r\n\r\n  return <>{children}</>;\r\n} "],"names":[],"mappings":";;;;AAEA;AACA;;;AAHA;;;AAUA,oCAAoC;AACpC,MAAM,sBAAsB;IAC1B,uCAAmC;;IAAW;IAE9C,MAAM,WAAW,OAAO,QAAQ,CAAC,QAAQ;IACzC,MAAM,WAAW,OAAO,QAAQ,CAAC,QAAQ;IACzC,MAAM,YAAY,IAAI,gBAAgB,OAAO,QAAQ,CAAC,MAAM;IAE5D,MAAM,iBAAiB;QAAC;QAAe;QAAe;KAAc;IAEpE,gCAAgC;IAChC,IAAI,aAAa,eAAe,aAAa,eAAe,aAAa,oBAAoB;QAC3F,MAAM,YAAY,SAAS,KAAK,CAAC,IAAI,CAAC,EAAE;QACxC,IAAI,eAAe,QAAQ,CAAC,YAAY;YACtC,OAAO;QACT;IACF;IAEA,iCAAiC;IACjC,MAAM,eAAe,SAAS,KAAK,CAAC,KAAK,MAAM,CAAC;IAChD,IAAI,aAAa,MAAM,GAAG,GAAG;QAC3B,MAAM,kBAAkB,YAAY,CAAC,EAAE;QACvC,IAAI,eAAe,QAAQ,CAAC,kBAAkB;YAC5C,OAAO;QACT;IACF;IAEA,0BAA0B;IAC1B,MAAM,cAAc,UAAU,GAAG,CAAC;IAClC,IAAI,eAAe,eAAe,QAAQ,CAAC,cAAc;QACvD,OAAO;IACT;IAEA,0BAA0B;IAC1B,IAAI,aAAa,eAAe,aAAa,eAAe,aAAa,oBAAoB;QAC3F,OAAO;IACT;IAEA,OAAO;AACT;AAEe,SAAS,eAAe,EAAE,QAAQ,EAAE,gBAAgB,EAAuB;;IACxF,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IACpE,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACzC,MAAM,eAAe,CAAA,GAAA,qIAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,WAAW,CAAA,GAAA,qIAAA,CAAA,cAAW,AAAD;IAE3B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,YAAY;QACd;mCAAG,EAAE;IAEL,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,IAAI,UAAU;gBACZ,MAAM,SAAS;gBACf,kBAAkB;gBAClB,mBAAmB;YACrB;QACF;mCAAG;QAAC;QAAU;QAAc;QAAU;KAAiB;IAEvD,0CAA0C;IAC1C,IAAI,CAAC,UAAU;QACb,OAAO;IACT;IAEA,qBAAO;kBAAG;;AACZ;GAxBwB;;QAGD,qIAAA,CAAA,kBAAe;QACnB,qIAAA,CAAA,cAAW;;;KAJN","debugId":null}},
    {"offset": {"line": 654, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/theredpotion/apps/customer/src/app/contexts/TenantContext.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { TenantConfig, getTenantConfig } from '../utils/tenant';\r\nimport TenantDetector from '../components/TenantDetector';\r\n\r\ninterface TenantContextType {\r\n  tenant: TenantConfig | null;\r\n  tenantId: string | null;\r\n  isLoading: boolean;\r\n  refreshTenant: () => void;\r\n}\r\n\r\nconst TenantContext = createContext<TenantContextType | undefined>(undefined);\r\n\r\ninterface TenantProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\n\r\n\r\nexport const TenantProvider: React.FC<TenantProviderProps> = ({ children }) => {\r\n  const [tenant, setTenant] = useState<TenantConfig | null>(null);\r\n  const [tenantId, setTenantId] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  const handleTenantDetected = async (detectedTenantId: string | null) => {\r\n    if (!detectedTenantId) {\r\n      setTenantId(null);\r\n      setTenant(null);\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      console.log('ðŸª Fetching tenant config for:', detectedTenantId);\r\n      \r\n      // Fetch tenant configuration from API with timeout\r\n      const controller = new AbortController();\r\n      const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 second timeout\r\n      \r\n      const response = await fetch(`/api/liff/config?tenantId=${detectedTenantId}`, {\r\n        signal: controller.signal\r\n      });\r\n      clearTimeout(timeoutId);\r\n      \r\n      if (!response.ok) {\r\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n      }\r\n      \r\n      const result = await response.json();\r\n      console.log('ðŸª API Response:', result);\r\n      \r\n      if (result.success) {\r\n        const apiConfig = result.data;\r\n        \r\n        // Convert API response to TenantConfig format\r\n        const tenantConfig: TenantConfig = {\r\n          id: apiConfig.tenantId,\r\n          name: apiConfig.name,\r\n          subdomain: apiConfig.tenantId,\r\n          domain: apiConfig.domain || `${apiConfig.tenantId}.theredpotion.com`,\r\n          liffId: apiConfig.liffId,\r\n          theme: {\r\n            primaryColor: apiConfig.theme.primaryColor,\r\n            logo: apiConfig.theme.logo,\r\n            brandName: apiConfig.name\r\n          },\r\n          settings: {\r\n            deliveryFee: 39,\r\n            freeDeliveryThreshold: 200,\r\n            serviceFeeRate: 0.02,\r\n            currency: 'THB'\r\n          }\r\n        };\r\n        \r\n        console.log('ðŸª Tenant config from API:', tenantConfig);\r\n        setTenantId(detectedTenantId);\r\n        setTenant(tenantConfig);\r\n      } else {\r\n        console.error('Failed to fetch tenant config:', result.message);\r\n        // Fallback to static config\r\n        const tenantConfig = getTenantConfig(detectedTenantId);\r\n        setTenantId(detectedTenantId);\r\n        setTenant(tenantConfig);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching tenant config:', error);\r\n      // Fallback to static config\r\n      const tenantConfig = getTenantConfig(detectedTenantId);\r\n      setTenantId(detectedTenantId);\r\n      setTenant(tenantConfig);\r\n    }\r\n    \r\n    setIsLoading(false);\r\n  };\r\n\r\n  const refreshTenant = () => {\r\n    // This will be handled by TenantDetector\r\n    setIsLoading(true);\r\n  };\r\n\r\n  const value: TenantContextType = {\r\n    tenant,\r\n    tenantId,\r\n    isLoading,\r\n    refreshTenant\r\n  };\r\n\r\n  return (\r\n    <TenantContext.Provider value={value}>\r\n      <TenantDetector onTenantDetected={handleTenantDetected}>\r\n        {children}\r\n      </TenantDetector>\r\n    </TenantContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useTenant = (): TenantContextType => {\r\n  const context = useContext(TenantContext);\r\n  if (context === undefined) {\r\n    throw new Error('useTenant must be used within a TenantProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\n// Hook for getting tenant-specific settings\r\nexport const useTenantSettings = () => {\r\n  const { tenant } = useTenant();\r\n  \r\n  return {\r\n    deliveryFee: tenant?.settings.deliveryFee || 39,\r\n    freeDeliveryThreshold: tenant?.settings.freeDeliveryThreshold || 200,\r\n    serviceFeeRate: tenant?.settings.serviceFeeRate || 0.02,\r\n    currency: tenant?.settings.currency || 'THB',\r\n    primaryColor: tenant?.theme.primaryColor || '#10b981',\r\n    brandName: tenant?.theme.brandName || 'The Red Potion',\r\n    logo: tenant?.theme.logo || '/images/logo.png'\r\n  };\r\n};\r\n\r\n// Hook for tenant-aware API calls\r\nexport const useTenantApi = () => {\r\n  const { tenantId } = useTenant();\r\n  \r\n  const getApiUrl = (endpoint: string) => {\r\n    if (!tenantId) return `/api${endpoint}`;\r\n    return `/api/tenant/${tenantId}${endpoint}`;\r\n  };\r\n  \r\n  return { getApiUrl };\r\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 819, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/theredpotion/apps/customer/src/app/contexts/AuthContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { useTenant } from './TenantContext';\n\n// Types\ninterface LineProfile {\n  userId: string;\n  displayName: string;\n  pictureUrl?: string;\n  statusMessage?: string;\n  email?: string;\n}\n\ninterface User {\n  id: string;\n  lineId: string;\n  displayName: string;\n  email?: string;\n  pictureUrl?: string;\n  role: string;\n  loginProvider: string;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  isAuthenticated: boolean;\n  isLoading: boolean;\n  login: () => Promise<void>;\n  logout: () => void;\n  refreshUser: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\n// Use existing LIFF types from utils/liff.ts\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const { tenant, tenantId } = useTenant();\n\n  // Initialize LIFF with tenant-specific LIFF ID\n  const initializeLIFF = async (): Promise<boolean> => {\n    try {\n      // Check if LIFF is available\n      if (typeof window === 'undefined' || !window.liff) {\n        console.log('LIFF SDK not available');\n        return false;\n      }\n\n      // Wait for tenant to be loaded\n      if (!tenant || !tenant.liffId) {\n        console.log('Waiting for tenant configuration...', { tenant, tenantId });\n        return false;\n      }\n\n      // Get LIFF ID for current tenant\n      const liffId = tenant.liffId;\n      if (!liffId) {\n        console.log('No LIFF ID configured for tenant:', tenantId);\n        return false;\n      }\n\n      // Check if LIFF is already initialized with the same LIFF ID\n      if (window.liff.isReady && window.liff.isReady()) {\n        console.log('LIFF already initialized');\n        return true;\n      }\n\n      // Initialize LIFF with tenant-specific LIFF ID\n      console.log(`ðŸ”¥ Initializing LIFF for tenant: ${tenantId} with LIFF ID: ${liffId}`);\n      await window.liff.init({ liffId });\n      console.log('âœ… LIFF initialized successfully for tenant:', tenantId);\n      return true;\n    } catch (error) {\n      console.error('âŒ LIFF initialization failed:', error);\n      return false;\n    }\n  };\n\n  // Check authentication status\n  const checkAuthStatus = async () => {\n    try {\n      setIsLoading(true);\n\n      // Skip if tenant is not loaded yet\n      if (!tenant || !tenant.liffId) {\n        console.log('Skipping auth check - tenant not ready');\n        setIsLoading(false);\n        return;\n      }\n\n      // Try to initialize LIFF first\n      const liffInitialized = await initializeLIFF();\n      \n             if (liffInitialized && window.liff && window.liff.isLoggedIn()) {\n         // User is logged in with LINE\n         const profile = await window.liff.getProfile();\n         const idToken = window.liff.getIDToken();\n\n        // Send LINE profile to backend for authentication\n        const response = await fetch('/api/auth/line', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            lineId: profile.userId,\n            lineProfile: {\n              displayName: profile.displayName,\n              email: profile.email,\n              pictureUrl: profile.pictureUrl,\n            },\n            idToken,\n            tenantId,\n          }),\n        });\n\n        const result = await response.json();\n\n        if (result.success) {\n          const userData: User = {\n            id: result.data.user.id,\n            lineId: result.data.user.lineId,\n            displayName: result.data.user.lineDisplayName || profile.displayName,\n            email: result.data.user.email || profile.email,\n            pictureUrl: result.data.user.linePictureUrl || profile.pictureUrl,\n            role: result.data.user.role,\n            loginProvider: result.data.user.loginProvider,\n          };\n\n          setUser(userData);\n          setIsAuthenticated(true);\n\n          // Store token for API calls\n          localStorage.setItem('auth_token', result.data.token);\n        } else {\n          console.error('Backend authentication failed:', result.message);\n          setIsAuthenticated(false);\n        }\n      } else {\n        // Not logged in or LIFF not available\n        setIsAuthenticated(false);\n        \n        // Check if we have stored token (fallback)\n        const storedToken = localStorage.getItem('auth_token');\n        if (storedToken) {\n          try {\n            const response = await fetch('/api/auth/me', {\n              headers: {\n                'Authorization': `Bearer ${storedToken}`,\n              },\n            });\n\n            const result = await response.json();\n            if (result.success) {\n              const userData: User = {\n                id: result.data.user.id,\n                lineId: result.data.user.lineId,\n                displayName: result.data.user.lineDisplayName || result.data.user.firstName,\n                email: result.data.user.email,\n                pictureUrl: result.data.user.linePictureUrl,\n                role: result.data.user.role,\n                loginProvider: result.data.user.loginProvider,\n              };\n\n              setUser(userData);\n              setIsAuthenticated(true);\n            } else {\n              localStorage.removeItem('auth_token');\n            }\n          } catch (error) {\n            console.error('Token validation failed:', error);\n            localStorage.removeItem('auth_token');\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Auth check failed:', error);\n      setIsAuthenticated(false);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Login function\n  const login = async (): Promise<void> => {\n    try {\n      const liffInitialized = await initializeLIFF();\n      \n             if (liffInitialized && window.liff) {\n         if (!window.liff.isLoggedIn()) {\n           // Redirect to LINE login\n           window.liff.login();\n        } else {\n          // Already logged in, just refresh user data\n          await checkAuthStatus();\n        }\n      } else {\n        // LIFF not available, show error or fallback\n        alert('LINE Login à¹„à¸¡à¹ˆà¸žà¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ à¸à¸£à¸¸à¸“à¸²à¹€à¸›à¸´à¸”à¸œà¹ˆà¸²à¸™ LINE App');\n      }\n    } catch (error) {\n      console.error('Login failed:', error);\n      alert('à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š');\n    }\n  };\n\n  // Logout function\n  const logout = (): void => {\n    try {\n      // Clear local storage\n      localStorage.removeItem('auth_token');\n      \n      // Clear state\n      setUser(null);\n      setIsAuthenticated(false);\n\n      // Logout from LIFF if available\n      if (typeof window !== 'undefined' && window.liff && window.liff.isLoggedIn()) {\n        window.liff.logout();\n      }\n    } catch (error) {\n      console.error('Logout failed:', error);\n    }\n  };\n\n  // Refresh user data\n  const refreshUser = async (): Promise<void> => {\n    await checkAuthStatus();\n  };\n\n  // Initialize auth on mount and tenant change\n  useEffect(() => {\n    // Only run when tenant is fully loaded with LIFF ID\n    if (tenant && tenant.liffId) {\n      checkAuthStatus();\n    }\n  }, [tenant, tenantId]);\n\n  const value: AuthContextType = {\n    user,\n    isAuthenticated,\n    isLoading,\n    login,\n    logout,\n    refreshUser,\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = (): AuthContextType => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}; "],"names":[],"mappings":"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","debugId":null}}]
}